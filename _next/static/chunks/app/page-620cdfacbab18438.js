(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6570:function(e,t,n){Promise.resolve().then(n.bind(n,5040))},4177:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(8421),s=n(2351),i=n(6008),o=n(2298);function r(){let e=(0,i.useRouter)(),{data:t,isLoading:n,error:r}=(0,s.a)({refetchOnWindowFocus:!0,staleTime:60,queryKey:["user"],queryFn:async()=>{let t=await (0,a.Z)();if(!t)return null;let n=await fetch("".concat("https://beta.typenomore.com","/api/user"),{headers:{"Content-Type":"application/json",accept:"application/json",Authorization:"Bearer ".concat(t)}}),s=await n.json(),{data:i}=s,r=401===s.code;return(r&&e.push("/login"),200!=s.code)?(e.push("/login"),null):(o.ZP.identify(i.id,i),i)}});return{user:t,isLoading:n,error:r}}},5040:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var a=n(9268),s=n(2026),i=n(6394),o=n.n(i),r=n(6008),l=n(6006),c=n(3590);async function u(e){let{text:t="Generate product requirement document or PRD for this design",imageBase64:n}=e,a=await fetch("https://api.openai.com/v1/chat/completions",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat("############")},method:"POST",body:JSON.stringify({model:"gpt-4-vision-preview",messages:[{role:"user",content:[{type:"text",text:t},{type:"image_url",image_url:{url:"data:image/png;base64,".concat(n)}}]}],max_tokens:1e3})}),s=await a.json();return s}var d=n(8421),p=n(4177),g=n(2913);function m(){let e=(0,r.useRouter)(),[t,n]=(0,l.useState)(""),[i,m]=(0,l.useState)({frames:[],imageBytes:new Uint8Array,imageBase64:""}),{frames:h,imageBytes:f,imageBase64:y}=i,[b,x]=(0,l.useState)(!1),[w,v]=(0,l.useState)("");(0,l.useEffect)(()=>((async()=>{let t=await (0,d.Z)();t||e.push("/login")})(),s.Z.run(async e=>{e.on("selectionchange",async()=>{e.ui.postMessage({message:{frames:[],imageBytes:[],imageBase64:""},type:"selectionchange"});let t=e.currentPage.selection;if(!t.length)return;let n=t[0],a=await n.exportAsync({format:"PNG"}),s=e.base64Encode(a);e.ui.postMessage({message:{frames:t,imageBytes:a,imageBase64:s},type:"selectionchange"})})}),window.onmessage=e=>{let{message:t,type:n}=e.data.pluginMessage;"selectionchange"!=n||w||m(t)},()=>{s.Z.run(async e=>{e.off("selectionchange",()=>{})})}),[]);let{user:j,isLoading:E,error:N}=(0,p.Z)();if(N)return"An error has occurred: "+N.message;if(E)return"Loading...";async function A(e){var t,n,a;null==e||e.preventDefault(),x(!0);let s="";{let e=await u({text:"Generate user story of every component for this design, make it clear and easy to read, seperate every section with clear and descruptive details",imageBase64:y});s=null==e?void 0:null===(a=e.choices)||void 0===a?void 0:null===(n=a[0])||void 0===n?void 0:null===(t=n.message)||void 0===t?void 0:t.content}v(s),x(!1)}return j||e.push("/login"),(0,a.jsx)("section",{className:"mx-auto flex w-full max-w-md flex-col gap-3 px-5 py-6",children:w?(0,a.jsxs)("article",{className:"flex w-full flex-col gap-3",children:[(0,a.jsx)("h2",{className:"",children:"Result"}),(0,a.jsx)(c.U,{className:" flex h-[375px] flex-col gap-3 overflow-auto rounded-md border border-[#DEE2E6] bg-white px-3 py-3.5 text-xs",children:w}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2.5",children:[(0,a.jsx)("button",{className:"btn btn-outline btn-primary btn-sm",onClick:()=>{v(""),A()},children:"Again"}),(0,a.jsx)("button",{className:"btn btn-outline btn-primary btn-sm",onClick:()=>(function(e){try{let t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),(0,g.Am)("Copied to clipboard",{type:"success"})}catch(e){console.log({error:e}),(0,g.Am)("Failed to copy",{type:"error"})}})(w),children:"Copy"}),(0,a.jsx)("button",{className:"btn btn-outline btn-primary btn-sm",onClick:()=>v(""),children:"Reset"})]})]}):(0,a.jsxs)("form",{className:"flex w-full flex-col gap-3",onSubmit:A,children:[(0,a.jsx)("h2",{className:"text-left ",children:h.length?"A frame is selected":"Please select a frame"}),(0,a.jsx)("div",{className:"h-36 w-full gap-2 overflow-hidden rounded-md border border-[#DEE2E6] bg-white",children:h.length?(0,a.jsx)(o(),{width:0,height:0,src:"data:image/png;base64,".concat(y),alt:"",className:"h-36 w-full bg-white object-contain"}):(0,a.jsx)("p",{className:"p-4 text-[#ADB5BD] ",children:"Your preview goes here"})}),(0,a.jsx)("div",{className:"flex flex-col",children:(0,a.jsxs)("select",{className:"select select-sm w-full",name:"type",id:"type",value:t,onChange:e=>n(e.target.value),disabled:!h.length||h.length>=2,children:[(0,a.jsx)("option",{value:"User Story",children:"User Story"}),(0,a.jsx)("option",{value:"type 2",children:"type 2"}),(0,a.jsx)("option",{value:"type 3",children:"type 3"}),(0,a.jsx)("option",{value:"type 4",children:"type 4"})]})}),(0,a.jsx)("button",{type:"submit",className:"btn btn-primary btn-sm btn-block disabled:bg-primary disabled:text-white",disabled:!h.length||h.length>=2||b,children:b?"⏳Generating...":"Generate"})]})})}},2026:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=new class{run(e,t){return new Promise((n,a)=>{let s=this.id++,i=e=>{var t,o;if(("https://www.figma.com"===e.origin||"https://staging.figma.com"===e.origin)&&((null===(t=e.data.pluginMessage)||void 0===t?void 0:t.type)==="EVAL_RESULT"&&e.data.pluginMessage.id===s&&(window.removeEventListener("message",i),n(e.data.pluginMessage.result)),(null===(o=e.data.pluginMessage)||void 0===o?void 0:o.type)==="EVAL_REJECT"&&e.data.pluginMessage.id===s)){window.removeEventListener("message",i);let t=e.data.pluginMessage.error;a(Error("string"==typeof t?t:"An error occurred in FigmaAPI.run()"))}};window.addEventListener("message",i);let o={pluginMessage:{type:"EVAL",code:e.toString(),id:s,params:t},pluginId:"*"};["https://www.figma.com","https://staging.figma.com"].forEach(e=>{try{parent.postMessage(o,e)}catch(e){}})})}constructor(){this.id=0}}},8421:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(2026);function s(){return a.Z.run(async e=>await e.clientStorage.getAsync("token"))}}},function(e){e.O(0,[891,671,351,96,253,961,744],function(){return e(e.s=6570)}),_N_E=e.O()}]);