(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{8628:function(t,e,s){Promise.resolve().then(s.bind(s,4893))},4177:function(t,e,s){"use strict";s.d(e,{Z:function(){return l}});var i=s(8421),n=s(6934),a=s.n(n),r=s(990),o=s(6008),u=s(2298);function l(){let t=(0,o.useRouter)(),e=(0,o.usePathname)(),{data:s,isLoading:n,error:l}=(0,r.a)({refetchOnWindowFocus:!0,refetchOnMount:!0,refetchOnReconnect:!0,staleTime:1/6*60,refetchInterval:1/6*6e4,queryKey:["user"],queryFn:async()=>{let s=await (0,i.Z)();if(!s)return null;let n=await fetch("".concat("https://typenomore.com","/api/user"),{headers:{"Content-Type":"application/json",accept:"application/json",Authorization:"Bearer ".concat(s)}}),r=await n.json(),{data:o}=r,l="/login/"===e||"/register/"===e,c=401===r.code;if(c&&!l)return t.push("/login");if(o.email_verified_at&&"/email/verification/"===e)return t.push("/");if(403===r.code){var d;let e=null===(d=r.data)||void 0===d?void 0:d.type;return"unverified_email"===e?t.push("/email/verification"):"unsubscription"===e?t.push("/subscription"):t.push("/403")}return(o.id&&u.ZP.identify(o.id,o),200==r.code||l)?(a().setUser(o.id,o.email,o.name),o):(a().notify("Failed to fetch user"),t.push("/login"),null)}});return{user:s,isLoading:n,error:l}}},2432:function(t,e,s){"use strict";function i(t){var e,s,i,n;let{response:a,setError:r}=t;null===(e=window)||void 0===e||e.scrollTo(0,0);let o=[];422==a.code&&(null===(s=a.data)||void 0===s?void 0:s.errors)?Object.keys(null===(i=a.data)||void 0===i?void 0:i.errors).forEach(t=>{var e,s,i;let n=null===(i=a.data)||void 0===i?void 0:null===(s=i.errors)||void 0===s?void 0:null===(e=s[t])||void 0===e?void 0:e[0];if(!n)return 1;o.push(n),r(t,{type:"custom",message:n},{shouldFocus:!0})}):r("global",{type:"custom",message:(null===(n=a.data)||void 0===n?void 0:n.message)||a.message||"Failed"})}s.d(e,{Z:function(){return i}})},4893:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return b}});var i=s(9268),n=s(5846),a=s.n(n),r=s(4177),o=s(8421),u=s(6934),l=s.n(u),c=s(8999);s(6006);var d=s(2913),h=s(6008),p=s(9700);function m(t){let{error:e,...s}=t,{register:n}=s;return(0,i.jsxs)("label",{htmlFor:null==s?void 0:s.id,className:"form-control w-full",children:[(null==s?void 0:s.label)&&(0,i.jsx)("div",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:null==s?void 0:s.label})}),(0,i.jsx)("textarea",{className:"textarea textarea-bordered w-full data-[iserror=true]:input-error","data-iserror":!!e,...n,...s}),e&&(0,i.jsx)("div",{className:"label text-start",children:(0,i.jsx)("span",{className:"label-text-alt text-error",children:e})})]})}var v=s(2432),f=s(5181);function b(){var t,e,s,n,o,u;let{user:l}=(0,r.Z)();return(0,i.jsxs)("main",{className:"flex min-h-[80vh] w-full flex-col  gap-4 p-4",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-1 ",children:[(0,i.jsx)("h3",{className:"m-0 text-xs font-semibold text-[#989898]",children:"ACCOUNT"}),(0,i.jsx)("p",{className:"m-0 ",children:null==l?void 0:l.name}),(0,i.jsx)("p",{className:"m-0 ",children:null==l?void 0:l.email}),(0,i.jsx)(a(),{href:"".concat("https://typenomore.com","/myaccount"),target:"_blank",className:"m-0 text-blue-500",children:"Change Password"})]}),(0,i.jsx)("hr",{}),(0,i.jsxs)("div",{className:"flex flex-col gap-1 ",children:[(0,i.jsx)("h3",{className:"m-0 text-xs font-semibold text-[#989898]",children:"SUBSCRIPTION"}),(0,i.jsxs)("p",{className:"m-0 ",children:["Status:"," ",(null==l?void 0:null===(t=l.related_subscription)||void 0===t?void 0:t.latest_status)===3?"Cancelled":(null==l?void 0:null===(e=l.related_subscription)||void 0===e?void 0:e.latest_status)===2?"Active":(null==l?void 0:null===(s=l.related_subscription)||void 0===s?void 0:s.latest_status)===1?"Created":"Unscubscribed"]}),(0,i.jsx)("p",{className:"m-0 ",children:(null==l?void 0:null===(n=l.related_subscription)||void 0===n?void 0:n.latest_status)===3?"Your subscription have been cancelled":"\n            Your next billing subscription is on\xa0\n            ".concat(new Date(null==l?void 0:null===(o=l.related_subscription)||void 0===o?void 0:o.next_billing_time).toLocaleDateString(),"\n            and will be auto renewed every month\n          ")}),(null==l?void 0:null===(u=l.related_subscription)||void 0===u?void 0:u.latest_status)===3?(0,i.jsx)(a(),{href:"".concat("https://typenomore.com","/subscription"),target:"_blank",className:"m-0 cursor-pointer text-blue-500",children:"Update Subscription"}):(0,i.jsx)(g,{})]}),(0,i.jsx)("hr",{})]})}function g(){var t,e,s,n;let a=(0,h.useRouter)(),{user:u}=(0,r.Z)(),b=(0,f.NL)(),{handleSubmit:g,register:y,formState:{errors:x,isDirty:w,isValid:C,isSubmitting:j},reset:_,setError:N,clearErrors:M}=(0,p.cI)({defaultValues:{reason:""}}),{mutateAsync:O,isPending:R,isSuccess:S}=(n=(null==u?void 0:null===(t=u.related_subscription)||void 0===t?void 0:t.paypal_subscription_id)||"",(0,c.D)({mutationKey:["user"],onError:t=>{l().notify(t),console.error(t),d.Am.error(t.message)},mutationFn:async t=>{let{reason:e}=t,s=await (0,o.Z)(),i=await fetch("".concat("https://typenomore.com","/api/paypal/subscription/cancel/").concat(n),{method:"PUT",headers:{"Content-Type":"application/json",accept:"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({reason:e})}),a=await i.json();return a}}));if(!(null==u?void 0:null===(e=u.related_subscription)||void 0===e?void 0:e.paypal_subscription_id))return null;async function E(t){let{reason:e}=t,s=await O({reason:e}),{data:i}=s;if(422==s.code){(0,v.Z)({response:s,setError:N});return}d.Am.success(s.message),b.invalidateQueries({queryKey:["user"]}),_(),a.push("/subscription")}return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("label",{htmlFor:"my_modal_1",className:"m-0 cursor-pointer text-blue-500",children:"Cancel"}),(0,i.jsx)("input",{type:"checkbox",id:"my_modal_1",className:"modal-toggle"}),(0,i.jsxs)("dialog",{id:"my_modal_1",className:"modal",children:[(0,i.jsx)("label",{className:"modal-backdrop",htmlFor:"my_modal_1",children:"Close"}),(0,i.jsxs)("div",{className:"modal-box",children:[(0,i.jsx)("h3",{className:"text-lg font-bold",children:"Cancel Subscription!"}),(0,i.jsx)("div",{className:"modal-action",children:(0,i.jsxs)("form",{method:"dialog",onSubmit:g(E),className:"flex w-full flex-col gap-4",children:[(0,i.jsx)(m,{placeholder:"Reason cancel subscription",error:null==x?void 0:null===(s=x.reason)||void 0===s?void 0:s.message,register:y("reason")}),(0,i.jsxs)("button",{type:"submit",className:"btn btn-primary btn-block disabled:bg-primary disabled:bg-opacity-20 disabled:text-white",disabled:j||!w||!C,onClick:()=>M(),children:[j&&(0,i.jsx)("span",{className:"loading loading-spinner"}),"Send"]})]})})]})]})]})}},2026:function(t,e,s){"use strict";s.d(e,{Z:function(){return i}});let i=new class{run(t,e){return new Promise((s,i)=>{let n=this.id++,a=t=>{var e,r;if(("https://www.figma.com"===t.origin||"https://staging.figma.com"===t.origin)&&((null===(e=t.data.pluginMessage)||void 0===e?void 0:e.type)==="EVAL_RESULT"&&t.data.pluginMessage.id===n&&(window.removeEventListener("message",a),s(t.data.pluginMessage.result)),(null===(r=t.data.pluginMessage)||void 0===r?void 0:r.type)==="EVAL_REJECT"&&t.data.pluginMessage.id===n)){window.removeEventListener("message",a);let e=t.data.pluginMessage.error;i(Error("string"==typeof e?e:"An error occurred in FigmaAPI.run()"))}};window.addEventListener("message",a);let r={pluginMessage:{type:"EVAL",code:t.toString(),id:n,params:e},pluginId:"*"};["https://www.figma.com","https://staging.figma.com"].forEach(t=>{try{parent.postMessage(r,t)}catch(t){}})})}constructor(){this.id=0}}},8421:function(t,e,s){"use strict";s.d(e,{Z:function(){return n}});var i=s(2026);function n(){return i.Z.run(async t=>await t.clientStorage.getAsync("token"))}},8468:function(t,e,s){"use strict";s.d(e,{R:function(){return o},m:function(){return r}});var i=s(9806),n=s(8115),a=s(7597),r=class extends n.F{#t;#e;#s;#i;constructor(t){super(),this.mutationId=t.mutationId,this.#e=t.defaultOptions,this.#s=t.mutationCache,this.#t=[],this.state=t.state||o(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options={...this.#e,...t},this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#t.includes(t)||(this.#t.push(t),this.clearGcTimeout(),this.#s.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#t=this.#t.filter(e=>e!==t),this.scheduleGc(),this.#s.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#t.length||("pending"===this.state.status?this.scheduleGc():this.#s.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(t){let e="pending"===this.state.status;try{if(!e){this.#n({type:"pending",variables:t}),await this.#s.config.onMutate?.(t,this);let e=await this.options.onMutate?.(t);e!==this.state.context&&this.#n({type:"pending",context:e,variables:t})}let s=await (this.#i=(0,a.Mz)({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(Error("No mutationFn found")),onFail:(t,e)=>{this.#n({type:"failed",failureCount:t,error:e})},onPause:()=>{this.#n({type:"pause"})},onContinue:()=>{this.#n({type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode}),this.#i.promise);return await this.#s.config.onSuccess?.(s,t,this.state.context,this),await this.options.onSuccess?.(s,t,this.state.context),await this.#s.config.onSettled?.(s,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(s,null,t,this.state.context),this.#n({type:"success",data:s}),s}catch(e){try{throw await this.#s.config.onError?.(e,t,this.state.context,this),await this.options.onError?.(e,t,this.state.context),await this.#s.config.onSettled?.(void 0,e,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,e,t,this.state.context),e}finally{this.#n({type:"error",error:e})}}}#n(t){this.state=(e=>{switch(t.type){case"failed":return{...e,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"pending":return{...e,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:!(0,a.Kw)(this.options.networkMode),status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...e,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:t.error,failureCount:e.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}})(this.state),i.V.batch(()=>{this.#t.forEach(e=>{e.onMutationUpdate(t)}),this.#s.notify({mutation:this,type:"updated",action:t})})}};function o(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}},8999:function(t,e,s){"use strict";s.d(e,{D:function(){return d}});var i=s(6006),n=s(8468),a=s(9806),r=s(6058),o=s(2323),u=class extends r.l{#a;#r=void 0;#o;#u;constructor(t,e){super(),this.#a=t,this.setOptions(e),this.bindMethods(),this.#l()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){let e=this.options;this.options=this.#a.defaultMutationOptions(t),(0,o.VS)(this.options,e)||this.#a.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#o,observer:this}),e?.mutationKey&&this.options.mutationKey&&(0,o.Ym)(e.mutationKey)!==(0,o.Ym)(this.options.mutationKey)?this.reset():this.#o?.state.status==="pending"&&this.#o.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#o?.removeObserver(this)}onMutationUpdate(t){this.#l(),this.#c(t)}getCurrentResult(){return this.#r}reset(){this.#o?.removeObserver(this),this.#o=void 0,this.#l(),this.#c()}mutate(t,e){return this.#u=e,this.#o?.removeObserver(this),this.#o=this.#a.getMutationCache().build(this.#a,this.options),this.#o.addObserver(this),this.#o.execute(t)}#l(){let t=this.#o?.state??(0,n.R)();this.#r={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#c(t){a.V.batch(()=>{if(this.#u&&this.hasListeners()){let e=this.#r.variables,s=this.#r.context;t?.type==="success"?(this.#u.onSuccess?.(t.data,e,s),this.#u.onSettled?.(t.data,null,e,s)):t?.type==="error"&&(this.#u.onError?.(t.error,e,s),this.#u.onSettled?.(void 0,t.error,e,s))}this.listeners.forEach(t=>{t(this.#r)})})}},l=s(5181),c=s(3524);function d(t,e){let s=(0,l.NL)(e),[n]=i.useState(()=>new u(s,t));i.useEffect(()=>{n.setOptions(t)},[n,t]);let r=i.useSyncExternalStore(i.useCallback(t=>n.subscribe(a.V.batchCalls(t)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),o=i.useCallback((t,e)=>{n.mutate(t,e).catch(c.Z)},[n]);if(r.error&&(0,c.L)(n.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:o,mutateAsync:r.mutate}}}},function(t){t.O(0,[342,834,846,700,253,961,744],function(){return t(t.s=8628)}),_N_E=t.O()}]);